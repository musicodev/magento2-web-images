<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
	<type name="Magento\Cms\Model\Wysiwyg\Images\Storage">
		<arguments>
			<argument name="extensions" xsi:type="array">
				<item name="allowed" xsi:type="array">
					<item name="avif" xsi:type="string">image/avif</item>
					<item name="svg-xml" xsi:type="string">image/svg+xml</item>
					<item name="webp" xsi:type="string">image/webp</item>
					<item name="svg" xsi:type="string">image/svg</item>
				</item>
				<item name="image_allowed" xsi:type="array">
					<item name="avif" xsi:type="string">image/avif</item>
					<item name="svg-xml" xsi:type="string">image/svg+xml</item>
					<item name="webp" xsi:type="string">image/webp</item>
					<item name="svg" xsi:type="string">image/svg</item>
				</item>
			</argument>
		</arguments>
	</type>
	<virtualType name="Magento\Catalog\CategoryImageUpload" type="Magento\Catalog\Model\ImageUploader">
		<arguments>
			<argument name="allowedExtensions" xsi:type="array">
				<item name="avif" xsi:type="string">avif</item>
				<item name="webp" xsi:type="string">webp</item>
				<item name="svg" xsi:type="string">svg</item>
			</argument>
			<argument name="allowedMimeTypes" xsi:type="array">
				<item name="avif" xsi:type="string">image/avif</item>
				<item name="svg-xml" xsi:type="string">image/svg+xml</item>
				<item name="webp" xsi:type="string">image/webp</item>
				<item name="svg" xsi:type="string">image/svg</item>
			</argument>
		</arguments>
	</virtualType>
	<type name="Magento\MediaGallerySynchronization\Model\FetchMediaStorageFileBatches">
		<arguments>
			<argument name="fileExtensions" xsi:type="array">
				<item name="avif" xsi:type="string">avif</item>
				<item name="webp" xsi:type="string">webp</item>
				<item name="svg" xsi:type="string">svg</item>
			</argument>
		</arguments>
	</type>
	<type name="Magento\Framework\Api\ImageContentValidator">
		<arguments>
			<argument name="allowedMimeTypes" xsi:type="array">
				<item name="avif" xsi:type="string">image/avif</item>
				<item name="svg-xml" xsi:type="string">image/svg+xml</item>
				<item name="webp" xsi:type="string">image/webp</item>
				<item name="svg" xsi:type="string">image/svg</item>
			</argument>
		</arguments>
	</type>
	<type name="Magento\MediaGalleryIntegration\Plugin\SaveImageInformation">
		<arguments>
			<argument name="imageExtensions" xsi:type="array">
				<item name="avif" xsi:type="string">avif</item>
				<item name="webp" xsi:type="string">webp</item>
				<item name="svg" xsi:type="string">svg</item>
			</argument>
		</arguments>
	</type>
	<type name="Magento\Catalog\Model\Product\Gallery\Processor">
		<plugin name="web-images-gallery-processor-plugin" type="MusicoDev\WebImages\Plugin\Product\Gallery\ProcessorPlugin" />
	</type>
	<type name="Magento\MediaStorage\App\Media">
		<plugin name="web-images-media-plugin" type="MusicoDev\WebImages\Plugin\App\MediaPlugin" />
	</type>
	<type name="Magento\MediaStorage\Model\File\Uploader">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\File\UploaderPlugin" />
	</type>
	<type name="Magento\MediaStorage\Model\File\Validator\NotProtectedExtension">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\File\Validator\NotProtectedExtensionPlugin" />
	</type>
	<type name="Magento\Cms\Model\Wysiwyg\Images\Storage">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Wysiwyg\Images\StoragePlugin" />
	</type>
	<type name="Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\Thumbnail">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Controller\Adminhtml\Wysiwyg\Images\ThumbnailPlugin" />
	</type>
	<type name="Magento\Cms\Controller\Adminhtml\Wysiwyg\Directive">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Controller\Adminhtml\Wysiwyg\DirectivePlugin" />
	</type>
	<type name="Magento\Theme\Model\Design\Backend\Logo">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Design\Backend\ImagePlugin" />
	</type>
	<type name="Magento\Theme\Model\Design\Backend\Favicon">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Design\Backend\ImagePlugin" />
	</type>
	<type name="Magento\Theme\Model\Design\Backend\Image">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Design\Backend\ImagePlugin" />
	</type>
	<type name="Magento\Swatches\Helper\Media">
		<plugin name="allow-web-images" type="MusicoDev\WebImages\Plugin\Swatches\Helper\MediaPlugin" />
	</type>
	<type name="Magento\MediaStorage\Service\ImageResizeScheduler">
		<plugin name="web-images-resize-scheduler-plugin" type="MusicoDev\WebImages\Plugin\MediaStorage\ImageResizeSchedulerPlugin" />
	</type>
	<type name="Magento\MediaStorage\Service\ImageResize">
		<plugin name="web-images-resize-plugin" type="MusicoDev\WebImages\Plugin\MediaStorage\ImageResizePlugin" />
	</type>
	<type name="Magento\MediaGallerySynchronization\Model\CreateAssetFromFile">
		<arguments>
			<argument name="assetFactory" xsi:type="object">MusicoDev\WebImages\Model\AssetFactory</argument>
		</arguments>
	</type>
	<type name="Magento\PageBuilder\Controller\Adminhtml\ContentType\Image\Upload">
		<arguments>
			<argument name="uploaderFactory" xsi:type="object">MusicoDev\WebImages\Model\File\UploaderFactory</argument>
		</arguments>
	</type>
</config>
